<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" layout:decorate="~{nurse/nurse_layout}">

<div layout:fragment="content" class="container-fluid my-4">

    <!-- í—¤ë” ì„¹ì…˜ -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border shadow-sm">
                <div class="card-header bg-dark text-white">
                    <h3 class="mb-0">ê°„í˜¸ì‚¬ ì •ë³´ ìˆ˜ì • íˆìŠ¤í† ë¦¬</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- ê²€ìƒ‰ ì„¹ì…˜ -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-secondary">ê²€ìƒ‰ ë° í•„í„°</h6>
                </div>
                <div class="card-body">
                    <form th:action="@{/nurse/history/search}" method="get" class="row g-3">
                        <div class="col-md-8">
                            <div class="input-group">
                                <span class="input-group-text bg-white border-end-0">
                                    <span class="text-muted">ğŸ”</span>
                                </span>
                                <input type="text"
                                       name="name"
                                       th:value="${searchName}"
                                       class="form-control border-start-0"
                                       placeholder="ê°„í˜¸ì‚¬ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•˜ì„¸ìš”...">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <button type="submit" class="btn btn-dark me-2">ê²€ìƒ‰</button>
                            <a th:href="@{/nurse/history}" class="btn btn-outline-secondary">ì „ì²´ ì¡°íšŒ</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- ê²°ê³¼ í†µê³„ -->
    <div class="row mb-3">
        <div class="col-12">
            <div class="alert alert-light border">
                <div class="d-flex align-items-center">
                    <span class="text-muted me-2">ğŸ“Š</span>
                    <span>
                        ì´ <strong class="text-dark" th:text="${#lists.size(historyList)}">0</strong>ê±´ì˜ ìˆ˜ì • ì´ë ¥ì´ ìˆìŠµë‹ˆë‹¤.
                        <span th:if="${searchName != null and !#strings.isEmpty(searchName)}" class="text-muted">
                            (ê²€ìƒ‰ì–´: "<span class="fw-bold text-dark" th:text="${searchName}"></span>")
                        </span>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- íˆìŠ¤í† ë¦¬ í…Œì´ë¸” -->
    <div class="row">
        <div class="col-12">
            <div class="card border">
                <div class="card-header bg-light">
                    <h6 class="mb-0 text-secondary">ìˆ˜ì • íˆìŠ¤í† ë¦¬ ëª©ë¡</h6>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead class="w-100">
                            <tr class="text-nowrap">
                                <th class="text-center" style="width: 60px;">No</th>
                                <th class="text-center" style="width: 140px;">ìˆ˜ì •ì¼ì‹œ</th>
                                <th class="text-center" style="width: 180px;">ê°„í˜¸ì‚¬ëª…</th>
                                <th class="text-center" style="width: 100px;">ë¶€ì„œ</th>
                                <th class="text-center" style="width: 100px;">ì§ê¸‰</th>
                                <th class="text-center" style="width: 120px;">ìˆ˜ì •ì</th>
                                <th class="text-center" style="width: 140px;">ì—°ë½ì²˜</th>
                                <th class="text-center" style="width: 100px;">ìƒì„¸ë³´ê¸°</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr th:if="${#lists.isEmpty(historyList)}">
                                <td colspan="8" class="text-center text-muted py-5">
                                    <div class="mb-3" style="font-size: 2.5rem;">ğŸ“‹</div>
                                    <div class="mb-2">ìˆ˜ì • ì´ë ¥ì´ ì—†ìŠµë‹ˆë‹¤.</div>
                                    <small>ë“±ë¡ëœ íˆìŠ¤í† ë¦¬ê°€ ì—†ìŠµë‹ˆë‹¤.</small>
                                </td>
                            </tr>
                            <tr th:each="history, stat : ${historyList}" class="align-middle">
                                <td class="text-center" style="width: 60px;">
                                    <span class="badge bg-secondary" th:text="${stat.count}">1</span>
                                </td>
                                <td style="width: 140px;">
                                    <div class="d-flex text-center flex-column">
                                        <span class="fw-bold text-dark" th:text="${#temporals.format(history.createDate, 'yyyy-MM-dd')}">2024-01-01</span>
                                        <small class="text-muted" th:text="${#temporals.format(history.createDate, 'HH:mm')}">10:00</small>
                                    </div>
                                </td>
                                <td style="width: 180px;">
                                    <div class="d-flex text-center flex-column">
                                        <span class="fw-bold text-dark" th:text="${history.firstName + ' ' + history.lastName}">í™ê¸¸ë™</span>
                                        <small th:if="${history.middleName != null and !#strings.isEmpty(history.middleName)}"
                                               class="text-muted"
                                               th:text="|ì¤‘ê°„ëª…: ${history.middleName}|"></small>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 100px;">
                                    <span th:if="${history.dept != null and !#strings.isEmpty(history.dept)}"
                                          class="badge bg-light text-dark border"
                                          th:text="${history.dept}">ë¶€ì„œ</span>
                                    <span th:unless="${history.dept != null and !#strings.isEmpty(history.dept)}"
                                          class="text-muted">-</span>
                                </td>
                                <td class="text-center" style="width: 100px;">
                                    <span th:if="${history.rank != null and !#strings.isEmpty(history.rank)}"
                                          class="badge bg-secondary"
                                          th:text="${history.rank}">ì§ê¸‰</span>
                                    <span th:unless="${history.rank != null and !#strings.isEmpty(history.rank)}"
                                          class="text-muted">-</span>
                                </td>
                                <td class="text-center" style="width: 120px;">
                                    <div class="d-flex flex-column">
                                        <span class="small fw-bold" th:text="${history.modifier != null ? history.modifier : history.writer}">ì‘ì„±ì</span>
                                        <span th:if="${history.modifier != null}" class="badge bg-warning text-dark small">ìˆ˜ì •ë¨</span>
                                        <span th:unless="${history.modifier != null}" class="badge bg-light text-dark small">ìƒì„±</span>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 140px;">
                                    <div class="d-flex flex-column">
                                        <span th:if="${history.tel != null and !#strings.isEmpty(history.tel)}"
                                              class="small text-dark"
                                              th:text="${history.tel}">010-1234-5678</span>
                                        <span th:unless="${history.tel != null and !#strings.isEmpty(history.tel)}"
                                              class="small text-muted">ì—°ë½ì²˜ ì—†ìŒ</span>
                                        <span th:if="${history.email != null and !#strings.isEmpty(history.email)}"
                                              class="small text-muted"
                                              th:text="${history.email}">email@example.com</span>
                                    </div>
                                </td>
                                <td class="text-center" style="width: 100px;">
                                    <a th:href="@{|/nurse/history/detail/${history.id}|}"
                                       class="btn btn-outline-dark btn-sm">
                                        ìƒì„¸ë³´ê¸°
                                    </a>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div th:if="${!#lists.isEmpty(historyList)}" class="card-footer bg-light border-top">
                    <div class="d-flex justify-content-between align-items-center">
                        <small class="text-muted">
                            ìµœì‹  ìˆœìœ¼ë¡œ ì •ë ¬ë˜ì—ˆìŠµë‹ˆë‹¤.
                        </small>
                        <small class="text-muted">
                            ì´ <span th:text="${#lists.size(historyList)}">0</span>ê±´ì˜ ê²°ê³¼
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

<style>
    /* í…Œì´ë¸” í˜¸ë²„ íš¨ê³¼ */
    .table-hover tbody tr:hover {
        background-color: rgba(0,0,0,0.02);
    }

    /* ì¹´ë“œ í˜¸ë²„ íš¨ê³¼ */
    .card {
        transition: box-shadow 0.2s ease;
    }

    .card:hover {
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    /* ê²€ìƒ‰ ì…ë ¥ í•„ë“œ */
    .input-group-text {
        border-color: #ced4da;
    }

    .form-control:focus {
        border-color: #495057;
        box-shadow: 0 0 0 0.2rem rgba(73, 80, 87, 0.25);
    }

    /* ë°°ì§€ ìŠ¤íƒ€ì¼ */
    .badge {
        font-size: 0.75rem;
        font-weight: 500;
    }

    /* ë¬´ì±„ìƒ‰ í…Œë§ˆ */
    .bg-light {
        background-color: #f8f9fa !important;
    }

    .bg-secondary {
        background-color: #6c757d !important;
    }

    .bg-dark {
        background-color: #343a40 !important;
    }

    .text-secondary {
        color: #6c757d !important;
    }

    .border {
        border-color: #dee2e6 !important;
    }

    /* ì•Œë¦¼ ë°•ìŠ¤ */
    .alert-light {
        background-color: #fefefe;
        border-color: #dee2e6;
        color: #495057;
    }

    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ìµœì í™” */
    @media (max-width: 768px) {
        .container-fluid {
            padding: 0.5rem;
        }

        /* í—¤ë” ìµœì í™” */
        .card-header h3 {
            font-size: 1.2rem;
            text-align: center;
        }

        /* ê²€ìƒ‰ ì„¹ì…˜ ëª¨ë°”ì¼ ìµœì í™” */
        .row.g-3 {
            margin: 0;
        }

        .row.g-3 > * {
            padding: 0.25rem;
            margin-bottom: 0.5rem;
        }

        .col-md-8, .col-md-4 {
            flex: 0 0 100%;
            max-width: 100%;
        }

        .input-group {
            margin-bottom: 0.5rem;
        }

        .btn {
            font-size: 0.85rem;
            padding: 0.4rem 0.8rem;
            margin-bottom: 0.25rem;
        }

        /* í†µê³„ ì„¹ì…˜ ìµœì í™” */
        .alert {
            padding: 0.75rem;
            font-size: 0.9rem;
        }

        /* í…Œì´ë¸”ì„ ì¹´ë“œ í˜•íƒœë¡œ ë³€ê²½ (ëª¨ë°”ì¼) */
        .table-responsive {
            border: none;
        }

        .table {
            font-size: 0.8rem;
        }

        .table th, .table td {
            padding: 0.4rem 0.2rem;
            vertical-align: middle;
        }

        /* í…Œì´ë¸” í—¤ë” ìˆ¨ê¸°ê¸° ë° ì¹´ë“œ ìŠ¤íƒ€ì¼ ì ìš© */
        .table thead {
            display: none;
        }

        .table tbody tr {
            display: block;
            border: 1px solid #dee2e6;
            margin-bottom: 0.75rem;
            border-radius: 0.375rem;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .table tbody td {
            display: block;
            text-align: left !important;
            border: none;
            padding: 0.5rem 0.75rem;
            position: relative;
            padding-left: 35% !important;
        }

        .table tbody td:before {
            content: attr(data-label);
            position: absolute;
            left: 0.75rem;
            width: 30%;
            text-align: left;
            font-weight: 600;
            color: #6c757d;
            font-size: 0.75rem;
        }

        .table tbody td:first-child:before {
            content: "No";
        }

        .table tbody td:nth-child(2):before {
            content: "ìˆ˜ì •ì¼ì‹œ";
        }

        .table tbody td:nth-child(3):before {
            content: "ê°„í˜¸ì‚¬ëª…";
        }

        .table tbody td:nth-child(4):before {
            content: "ë¶€ì„œ";
        }

        .table tbody td:nth-child(5):before {
            content: "ì§ê¸‰";
        }

        .table tbody td:nth-child(6):before {
            content: "ìˆ˜ì •ì";
        }

        .table tbody td:nth-child(7):before {
            content: "ì—°ë½ì²˜";
        }

        .table tbody td:nth-child(8):before {
            content: "ìƒì„¸ë³´ê¸°";
        }

        /* ë°°ì§€ í¬ê¸° ì¡°ì • */
        .badge {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
        }

        /* ë²„íŠ¼ í¬ê¸° ì¡°ì • */
        .btn-sm {
            padding: 0.3rem 0.6rem;
            font-size: 0.75rem;
        }

        /* ì¹´ë“œ í‘¸í„° ìµœì í™” */
        .card-footer {
            padding: 0.5rem 0.75rem;
        }

        .card-footer .d-flex {
            flex-direction: column;
            gap: 0.25rem;
        }

        /* í•˜ë‹¨ ì•ˆë‚´ ì„¹ì…˜ ìµœì í™” */
        .row.text-center .col-md-4 {
            flex: 0 0 100%;
            max-width: 100%;
            margin-bottom: 1rem;
        }

        .row.text-center .col-md-4:last-child {
            margin-bottom: 0;
        }
    }

    /* íƒœë¸”ë¦¿ ìµœì í™” */
    @media (max-width: 992px) and (min-width: 769px) {
        .container-fluid {
            padding: 0.75rem;
        }

        .table th, .table td {
            padding: 0.6rem 0.4rem;
            font-size: 0.9rem;
        }

        .btn {
            font-size: 0.9rem;
        }

        /* í…Œì´ë¸” ì •ìƒ í‘œì‹œ (íƒœë¸”ë¦¿ì—ì„œëŠ”) */
        .table thead {
            display: table-header-group;
        }

        .table tbody tr {
            display: table-row;
            border: none;
            margin: 0;
            border-radius: 0;
            background: transparent;
            box-shadow: none;
        }

        .table tbody td {
            display: table-cell;
            padding-left: 0.4rem !important;
        }

        .table tbody td:before {
            display: none;
        }
    }

    /* ì•„ì£¼ ì‘ì€ í™”ë©´ (iPhone SE ë“±) */
    @media (max-width: 576px) {
        .my-4 {
            margin: 0.5rem 0 !important;
        }

        .mb-4, .mb-3 {
            margin-bottom: 0.75rem !important;
        }

        .card-header h3 {
            font-size: 1rem;
            padding: 0.5rem;
        }

        .card-body {
            padding: 0.75rem;
        }

        .table tbody td {
            padding: 0.4rem 0.5rem;
            padding-left: 32% !important;
            font-size: 0.75rem;
        }

        .table tbody td:before {
            left: 0.5rem;
            width: 28%;
            font-size: 0.7rem;
        }

        .alert {
            padding: 0.5rem;
            font-size: 0.85rem;
        }

        .btn {
            font-size: 0.8rem;
            padding: 0.35rem 0.7rem;
        }
    }

    /* í° í™”ë©´ ìµœì í™” */
    @media (min-width: 1200px) {
        .container-fluid {
            max-width: 1400px;
            margin: 0 auto;
        }

        .table th, .table td {
            padding: 0.75rem 0.5rem;
        }
    }

    /* í…Œì´ë¸” ë°˜ì‘í˜• ë³´ì¡° - ì‘ì€ í™”ë©´ì—ì„œ í…Œì´ë¸” ë³µì› */
    @media (min-width: 769px) {
        .table thead {
            display: table-header-group !important;
        }

        .table tbody tr {
            display: table-row !important;
            border: none !important;
            margin: 0 !important;
            border-radius: 0 !important;
            background: transparent !important;
            box-shadow: none !important;
        }

        .table tbody td {
            display: table-cell !important;
            padding-left: 0.5rem !important;
        }

        .table tbody td:before {
            display: none !important;
        }
    }
</style>

</html>